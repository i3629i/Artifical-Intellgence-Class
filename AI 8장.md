# 제약충족문제

## 1. 제약충족 문제 정의
### 제약 충족??
* 변수에 대한 모든 제약을 만족하는 값을 가질 때 문제 해결

Ex. 지도 채색 문제에서 모든 지도에 R,G,B 값이 서로 닫지 않게 <=제약을 만족하면 문제 해결
<br>
### 제약 충족의 구성요소
* 변수 집합
* 도메인
* 제약집합 - [(A,B),(B,A)] 식으로 열거하거나 X1 != X2 이런 식으로 조건을q 걸어 제약을 둠
![image](https://user-images.githubusercontent.com/50629716/85278869-84071a80-b4c0-11ea-8e95-b91041c8eb05.png)
* 변수 - {각 지역 들}
* 도메인 - {R,G,B}
* 제약 - {SA != WA, SA != NT, SA != Q, SA != NSW, SA != V, WA != NT .....등등등 }

### 해결책
* 어떠한 제약도 위반 하지 않게 배정되어야 한다.
* 모든 변수의 값에 값이 배정되어야 한다.

## 2. 제약 전파
### CSP알고리즘은 탐색 OR 제약전파
* 탐색 - 여러 가지중 하나 변수 배정선택
* 제약 전파 - 한 변수의 적합한 값 선정 -> 다른 변수 값의 제약을 걸어 영향을 끼침. 제약을 전파함

![image](https://user-images.githubusercontent.com/50629716/85280616-6edfbb00-b4c3-11ea-9b26-3789e3f438fc.png)


### 노드 일관성
* 하나의 변수 값의 도메인이 그 변수의 단원 제약(하나에 대한 제약)을 충족하면 **노드 일관적** 이다. 모든 변수가 노드 일관이면 네트워크도 노드 일관적 이라함.

### 아크 일관성
* 변수의 도메인 값들이 **이원 제약(변수 두개에 대한 제약)**을 충족하면, 아크 일관적
* 아크 일관성을 정욕해도 도메인이 축소 될 수도 있고 안 될 수도 있지만, 축소되면 탐색양을 줄일 수 있음.
####  AC-3알고리즘
* 도메인 집합 = 공집합 이면, 해결책이 없는 문제
* 축소를 통해 더 신속히 탐색 가능

### 경로 일관성
* **3개의 변수**를 살펴 추정되는 제약을 통해 이원 제약을 강화
<Br>도메인(R,B)만 가능 {WA ,SA}를 NT에 대해 경로 일관되게 만듬
<br>{WA = R, SA = B}, {WA = B, SA = R}
<Br> NT에 대한 색 선택이 불가능함.

##  3. 전역 제약
### 비일관성 탐지
* 도메인 크기가 1인 변수를 제약에서 삭제
* 나머지 변수들의 도메인에서 그 변수 삭제
* 도메인 크기가 1인 변수가 존재하는 한 반복
* 공집합 도메인이 발생
* 남은 도메인 값보다 변수가 많은 경우, 제약에 변수 m , 변수에 가능한 값 n, m > n이면 충족 불가능 

## 4. 역추적 탐색(Backtracking Search)
### 역추적 탐색
* 솔루션을 위해 DFS로 확장하다 제약조건이 걸리면 부모노드로 Backtracking 하여 방문하지 않응 노드 확장.
![image](https://user-images.githubusercontent.com/50629716/85281227-94b98f80-b4c4-11ea-9a4c-1e92652cec14.png)

### 최소 잔여 값(MRV), 최소 제약 값(LCV) 휴리스틱
#### MRV - fail first(실패 우선 휴리스틱)
* 남은 도메인의 값이 가장 적게남은 변수를 선택 - 실패를 빨리 인지하기 위해

#### LCV - fail-Last
* 이웃하는 변수에 선택을 가장 적게 배제하는 값
* ALLOW가 가장적은 0은 공집합이라 제외.
![image](https://user-images.githubusercontent.com/50629716/85281760-86b83e80-b4c5-11ea-8b45-3a26bc61e700.png)

## 5. 순방향 체킹(Forward checking)
![image](https://user-images.githubusercontent.com/50629716/85281932-cbdc7080-b4c5-11ea-8203-ab547d9e305a.png)
* WA가 RED면 이웃인 NT와 SA에서 RED를 지우는 방식.
* 문제의 제약과 일관 되지 않는다면 즉시 역추적 진행.

### 순방향 체크 vs 아크 일관성 유지
* 아크 일관성유지는 재귀적으로 제약을 전파하다보니 순방향 보다 효과적

![image](https://user-images.githubusercontent.com/50629716/85282529-dcd9b180-b4c6-11ea-802b-50ebad3c43b6.png)


## 6. CSP를 위한 국지적 탐색
### 최소 충돌 휴리스틱
* 다른 변수와 충돌이 최소화 되는 값 선택
* 8-퀸 같은 경우 가장 적게 충돌 나는곳 선택.
* 스케쥴링 문제에 중요


